<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
    <meta charset="utf-8">
    <title>{{ block('title') }}</title>
    <link rel="icon" href="https://static.fc2.com/share/image/favicon.ico">
    <link rel="stylesheet" href="/css/normalize.css" type="text/css" media="all">
    <link rel="stylesheet" href="/css/admin-fc2.css" type="text/css" media="all">
    <link rel="stylesheet" href="/css/admin-form.css" type="text/css" media="all">
    <link rel="stylesheet" href="/css/common.css" type="text/css" media="all">
    <link rel="stylesheet" href="/css/main.css" type="text/css" media="all">
    <link rel="stylesheet" href="/css/admin_style.css" type="text/css" media="all">

    {# <?php echo $this->includeCSS() }}  管理画面には不要？ #}

    <script type="text/javascript" src="/js/jquery/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/js/jquery/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="/js/jquery/jquery-ui/1.9.2/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="/css/jquery/jquery-ui/1.9.2/themes/ui-lightness/jquery-ui.css" type="text/css" media="screen">
    <script type="text/javascript" src="/js/common_design.js"></script>

    <script type="text/javascript" src="/js/common.js"></script>
    <script>
        // フレームワーク用のjsの設定
        let common = {{ js_common|json_encode()|raw }};
    </script>

    {# <?php echo $this->includeJS() }}  管理画面には不要？ #}

</head>
<body>

<header class="clear">
    <div>
        {% if isLogin %}
            <span>{{ nick_name }}</span>
        {% endif %}

        {% if isLogin %}
            <div id="blog_id">
                {{ _('Blog name') }}：
                <select id="sys-blog-change">
                    {% for key, blog in blog_list %}
                        <option value="{{ key }}" {% if blog_id == key %}selected="selected"{% endif %}>{{ blog }}</option>
                    {% endfor %}
                    <option disabled="disabled">--------------</option>
                    <option value="">{{ _('Create a new blog') }}</option>
                </select>
                <script>
                    $(function () {
                        $('#sys-blog-change').change(function () {
                            let value = $('#sys-blog-change').val();
                            if (value == '') { // TODO ふさわしい判定式に
                                location.href = "{{ url(req, {'controller': 'Blogs', 'action': 'create' }) }}";
                            } else {
                                location.href = common.fwURL('blogs', 'choice', {blog_id: value});
                            }
                        });
                    });
                </script>
            </div>
        {% endif %}
        <div id="switch_lang">
            <select id="sys-language-setting" onchange="location.href=common.fwURL('common', 'lang', {lang: $(this).val()});">
                <option value="ja" {% if lang == 'ja' %}selected="selected"{% endif %}>日本語</option>
                <option value="en" {% if lang == 'en' %}selected="selected"{% endif %}>English</option>
            </select>
        </div>
    </div>
</header>

<article>

    <nav id="left-nav">
        {% if isLogin %}

            {% if is_selected_blog %}
                <div class="menu">
                    <h3 class="home">{{ _('Home') }}</h3>
                    <ul>
                        <li><a href="{{ url(req, {'controller': 'Common', 'action': 'notice' }) }}">{{ _('Notice') }}</a></li>
                        <li><a href="{{ preview_active_blog_url }}" target="_blank">{{ _('Checking the blog') }}</a></li>
                        <li><a href="{{ url(req, {'controller': 'Entries', 'action': 'create' }) }}">{{ _('New article') }}</a></li>
                        <li><a href="{{ url(req, {'controller': 'Entries', 'action': 'index' }) }}">{{ _('List of articles') }}</a></li>
                        <li><a href="{{ url(req, {'controller': 'Comments', 'action': 'index' }) }}">{{ _('List of comments') }}</a></li>
                        <li><a href="{{ url(req, {'controller': 'Files', 'action': 'upload' }) }}">{{ _('Upload file') }}</a></li>
                    </ul>
                </div>

                <div class="menu">
                    <h3 class="setting">{{ _('Setting') }}</h3>
                    <ul>
                        <li><a href="{{ url(req, {'controller': 'BlogTemplates', 'action': 'index' }) }}">{{ _('Template management') }}</a></li>
                        <li><a href="{{ url(req, {'controller': 'blog_plugins', 'action': 'index' }) }}">{{ _('Plugin management') }}</a></li>
                        <li><a href="{{ url(req, {'controller': 'Categories', 'action': 'create' }) }}">{{ _('Category management') }}</a></li>
                        <li><a href="{{ url(req, {'controller': 'Tags', 'action': 'index' }) }}">{{ _('List of tags') }}</a></li>
                        <li><a href="{{ url(req, {'controller': 'Blogs', 'action': 'edit' }) }}">{{ _('Blog setting') }}</a></li>
                    </ul>
                </div>
            {% endif %}

            <div class="menu">
                <h3 class="account">{{ _('User Menu') }}</h3>
                <ul>
                    <li><a href="{{ url(req, {'controller': 'Blogs', 'action': 'index' }) }}">{{ _('List of blogs') }}</a></li>
                    <li><a href="{{ url(req, {'controller': 'Users', 'action': 'edit' }) }}">{{ _('User setting') }}</a></li>
                    <li><a href="{{ url(req, {'controller': 'Users', 'action': 'logout' }) }}">{{ _('Logout') }}</a></li>
                </ul>
            </div>

            {% if debug %}
                <div class="menu">
                    <h3 style="background-color:#999;background-position: 2px -660px;">デバッグ用</h3>
                    <ul>
                        <li><a href="{{ url(req, {'controller': 'Users', 'action': 'index' }) }}">ユーザー一覧</a></li>
                    </ul>
                </div>
            {% endif %}
        {% endif %}

        {% if not isLogin %}
            <div class="menu">
                <h3 style="background-color:#999;background-position: 2px -660px;">{{ _('User Menu') }}</h3>
                <ul>
                    {% if is_register_able %}
                        <li><a href="{{ url(req, {'controller': 'Users', 'action': 'register'}) }}">{{ _('User registration') }}</a></li>
                    {% endif %}
                    <li><a href="{{ url(req, {'controller': 'Users', 'action': 'login'}) }}">{{ _('Login') }}</a></li>
                </ul>
            </div>
        {% endif %}
    </nav>

    <article id="main-contents">
        {% include 'admin/flagments/flash_message.twig' %}
        {{ block('content') }}
    </article>

</article>
</body>
</html>
